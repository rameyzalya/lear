<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Arial;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px;display:flex;justify-content:center;align-items:center}
        .container{width:100%;max-width:500px}
        .todo-app{background:white;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
        h1{text-align:center;color:#333;margin-bottom:15px}
        .input-section{display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:8px;margin-bottom:8px}
        input,select,button{padding:8px;border:2px solid #ddd;border-radius:6px;font-size:14px}
        button{background:#667eea;color:white;border:none;cursor:pointer}
        .error{color:#e74c3c;font-size:12px;margin-bottom:10px;min-height:16px}
        .tabs{display:flex;gap:5px;margin-bottom:15px}
        .tab{flex:1;background:#f8f9fa;color:#666}
        .tab.active{background:#667eea;color:white}
        .task-list{min-height:300px}
        .task-item{display:flex;align-items:center;padding:10px;background:#f8f9fa;border-radius:6px;margin-bottom:5px;border-left:4px solid #ddd}
        .task-item.selesai{opacity:0.6;background:#e8f5e8}
        .task-item.tinggi{border-left-color:#e74c3c}.task-item.sedang{border-left-color:#f39c12}.task-item.rendah{border-left-color:#27ae60}
        .task-checkbox{margin-right:10px}
        .task-content{flex:1}
        .task-text{font-weight:500;margin-bottom:2px}
        .task-text.selesai{text-decoration:line-through}
        .task-details{font-size:11px;color:#666}
        .priority{padding:1px 6px;border-radius:8px;margin-right:5px;font-size:10px;color:white}
        .tinggi{background:#e74c3c}.sedang{background:#f39c12}.rendah{background:#27ae60}
        .task-actions{display:flex;gap:5px}
        .edit-btn{background:#3498db;padding:4px 8px;font-size:11px}
        .hapus-btn{background:#e74c3c;padding:4px 8px;font-size:11px}
    </style>
</head>
<body>
    <div class="container">
        <div class="todo-app">
            <h1>üìù To-Do List</h1>
            <div class="input-section">
                <input type="text" id="taskInput" placeholder="Tugas baru..." onkeypress="if(event.key=='Enter')addTask()">
                <input type="date" id="taskDate">
                <select id="taskPriority">
                    <option value="rendah">Rendah</option>
                    <option value="sedang">Sedang</option>
                    <option value="tinggi">Tinggi</option>
                </select>
                <button onclick="addTask()">+</button>
            </div>
            <div class="error" id="error"></div>
            <div class="tabs">
                <button class="tab active" onclick="switchTab('aktif')">Aktif</button>
                <button class="tab" onclick="switchTab('selesai')">Selesai</button>
            </div>
            <div class="task-list" id="taskList"></div>
        </div>
    </div>

    <script>
        let tasks = JSON.parse(localStorage.getItem("tasks")) || [], currentTab = "aktif", editingId = null;
        
        function addTask() {
            const input = document.getElementById("taskInput"), text = input.value.trim(), date = document.getElementById("taskDate").value, error = document.getElementById("error");
            error.textContent = "";
            if (!text) return error.textContent = "Nama tugas tidak boleh kosong";
            if (!date) return error.textContent = "Tanggal harus dipilih";
            tasks.push({id: Date.now(), text: text, completed: false, priority: document.getElementById("taskPriority").value, date: date});
            save(); render(); input.value = "";
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
            event.target.classList.add("active");
            editingId = null; render();
        }

        function toggleSelesai(id) {
            const task = tasks.find(t => t.id === id);
            if (task) task.completed = !task.completed;
            save(); render();
        }

        function startEdit(id) { editingId = id; render(); }

        function saveEdit(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.text = document.getElementById(`editText-${id}`).value.trim();
                task.date = document.getElementById(`editDate-${id}`).value;
                task.priority = document.getElementById(`editPriority-${id}`).value;
                save(); editingId = null; render();
            }
        }

        function hapusTask(id) { tasks = tasks.filter(task => task.id !== id); save(); render(); }

        function render() {
            const list = document.getElementById("taskList"), filtered = tasks.filter(task => currentTab === "aktif" ? !task.completed : task.completed);
            if (filtered.length === 0) return list.innerHTML = `<div style="text-align:center;color:#666;padding:40px">${currentTab==="aktif"?"Tidak ada tugas aktif":"Tidak ada tugas selesai"}</div>`;
            list.innerHTML = filtered.map(task => editingId === task.id ? `
                <div class="task-item ${task.priority}">
                    <div class="task-content">
                        <input type="text" value="${task.text}" id="editText-${task.id}">
                        <div style="display:flex;gap:5px;margin-top:5px">
                            <input type="date" value="${task.date}" id="editDate-${task.id}">
                            <select id="editPriority-${task.id}">
                                <option value="rendah" ${task.priority=='rendah'?'selected':''}>Rendah</option>
                                <option value="sedang" ${task.priority=='sedang'?'selected':''}>Sedang</option>
                                <option value="tinggi" ${task.priority=='tinggi'?'selected':''}>Tinggi</option>
                            </select>
                        </div>
                        <div class="task-actions" style="margin-top:5px">
                            <button class="edit-btn" onclick="saveEdit(${task.id})">Simpan</button>
                            <button class="hapus-btn" onclick="editingId=null;render()">Batal</button>
                        </div>
                    </div>
                </div>` : `
                <div class="task-item ${task.completed?'selesai':''} ${task.priority}">
                    <input type="checkbox" class="task-checkbox" ${task.completed?'checked':''} onchange="toggleSelesai(${task.id})">
                    <div class="task-content">
                        <div class="task-text ${task.completed?'selesai':''}">${task.text}</div>
                        <div class="task-details">
                            <span class="priority ${task.priority}">${task.priority.toUpperCase()}</span>
                            <span>üìÖ ${new Date(task.date).toLocaleDateString('id-ID')}</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="edit-btn" onclick="startEdit(${task.id})">Edit</button>
                        <button class="hapus-btn" onclick="hapusTask(${task.id})">Hapus</button>
                    </div>
                </div>`
            ).join("");
        }

        function save() { localStorage.setItem("tasks", JSON.stringify(tasks)); }

        document.getElementById("taskDate").value = new Date().toISOString().split("T")[0];
        render();
    </script>
</body>
</html>